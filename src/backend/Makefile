OCAML=ocamlfind ocamlc -linkpkg -package llvm -package llvm.analysis
INCLUDE=-I ../include
OCAML_FLAGS=$(INCLUDE) $(EXT_OBJS)
FRONTEND=../frontend
EXT_OBJS=$(FRONTEND)/ast.cmo
HEADERS=
OBJS=semant.cmo codegen.cmo
TARGETS=$(HEADERS) $(OBJS)

%: %.ml $(OBJS)
	$(OCAML) $(OCAML_FLAGS) -o $@ $(LIBS) $(OBJS) $<

all: $(TARGETS) $(OBJS)

%.cmo: %.ml
	ocamlfind ocamlc -package llvm $(OCAML_FLAGS) -c $<
%.cmi: %.mli
	$(OCAML) -c $(OCAML_FLAGS) -o $@ $<
%.cmx : %.ml
	ocamlfind ocamlc -c -package llvm $<
clean:
	rm -rf *.cmo *.cmi

#generated by ocamldep
codegen.cmo :
codegen.cmx :
semant.cmo :
semant.cmx :
